import"./modulepreload-polyfill-B5Qt9EMX.js";document.addEventListener("DOMContentLoaded",function(){const l=document.getElementById("shipping-payment-form"),u=document.getElementById("continue-to-step-2"),p=document.getElementById("continue-to-step-3"),I=document.getElementsByName("payment-method"),c=document.getElementById("credit-card-details"),y=document.getElementById("confirm-order-btn"),E=document.getElementById("order-summary");I.forEach(e=>{e.addEventListener("change",function(){this.value==="paypal"?c.style.display="none":["visa","mastercard","amex"].includes(this.value)?c.style.display="block":c.style.display="none"})}),u&&u.addEventListener("click",function(){if(!document.getElementById("user-info-form").checkValidity()){document.getElementById("user-info-form").reportValidity();return}const e=document.getElementById("name").value,t=document.getElementById("email").value,n=document.getElementById("phone").value;localStorage.setItem("userInfo",JSON.stringify({name:e,email:t,phone:n})),new bootstrap.Tab(document.getElementById("tab-step-2")).show()}),p&&p.addEventListener("click",function(){const e=document.querySelector('input[name="payment-method"]:checked').value;let t=!0;if(e!=="paypal"&&(t=l.checkValidity(),["visa","mastercard","amex"].includes(e)&&(t=t&&document.getElementById("card-number").value.trim()!==""&&document.getElementById("expiry-date").value.trim()!==""&&document.getElementById("security-code").value.trim()!=="")),!t){l.reportValidity();return}const n=document.getElementById("address-line-1").value,o=document.getElementById("address-line-2").value,a=document.getElementById("city").value,f=document.getElementById("state").value,d=document.getElementById("zip").value,i=document.getElementById("country").value;if(["visa","mastercard","amex"].includes(e)){const m=document.getElementById("card-number").value,s=document.getElementById("expiry-date").value,r=document.getElementById("security-code").value;localStorage.setItem("paymentInfo",JSON.stringify({cardNumber:m,expiryDate:s,securityCode:r}))}localStorage.setItem("shippingInfo",JSON.stringify({addressLine1:n,addressLine2:o,city:a,state:f,zip:d,country:i,paymentMethod:e})),e==="paypal"?(alert("Simulando redirección a PayPal para completar el pago."),setTimeout(()=>{g()},300)):g()});function g(){const e=JSON.parse(localStorage.getItem("userInfo")),t=JSON.parse(localStorage.getItem("shippingInfo")),n=JSON.parse(localStorage.getItem("cart"))||[];if(e&&t&&n.length>0){let o=`
                <div class="no-spacing">    
                <p><strong>Nombre:</strong> ${e.name}</p>
                <p><strong>Correo Electrónico:</strong> ${e.email}</p>
                <p><strong>Teléfono:</strong> ${e.phone}</p>
                <p><strong>Dirección de Envío:</strong> ${t.addressLine1} ${t.addressLine2}, ${t.city}, ${t.state}, ${t.zip}, ${t.country}</p>
                <p><strong>Método de Pago:</strong> ${t.paymentMethod}</p>
                <br>
                <h4>Resumen del Pedido:</h4>
                </div>
            `,a=0;n.forEach(d=>{const{item:i,size:m,quantity:s}=d,r=i.price*s;a+=r,o+=`
                    <ul class="custom-list">
                        <li><span>${i.name} - Talla ${m}</span></li>
                        <li><span>Cantidad: ${s}</span></li>
                        <li><span>Total: $${r.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})} MXN</span></li>
                    </ul>               
                     `}),o+=`
                <p><span><h4>Total del Pedido:</h4></span><span>$${a.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})} MXN</span></p>
            `,E.innerHTML=o,new bootstrap.Tab(document.getElementById("tab-step-3")).show()}else alert("Por favor completa todos los pasos anteriores para proceder.")}y&&y.addEventListener("click",function(){const e=document.getElementById("confirmation-message");e&&(e.textContent="¡Pedido confirmado! Gracias por tu compra.",e.style.display="block"),localStorage.removeItem("userInfo"),localStorage.removeItem("shippingInfo"),v(),setTimeout(()=>{window.location.href="../productos/productos.html"},3e3)});function v(){localStorage.removeItem("cart")}});
